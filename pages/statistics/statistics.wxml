<!--pages/statistics/statistics.wxml-->
<view class="container">
  <!-- 页面标题 -->
  <view class="header">
    <text class="title">时间赎回统计中心</text>
    <text class="subtitle">追踪你赎回的时间</text>
  </view>

  <!-- 总体统计卡片 -->
  <view class="overview-section">
    <view class="overview-card">
      <view class="overview-title">总体成就</view>
      

      

      

      

      
      <view class="overview-stats">
        <view class="stat-item">
          <view class="stat-value">{{totalRedeemedTimeDisplay}}</view>
          <view class="stat-label">小时</view>
          <view class="stat-desc">赎回时间</view>
        </view>
        <view class="stat-item">
          <view class="stat-value">{{costEfficiency}}</view>
          <view class="stat-label">%</view>
          <view class="stat-desc">赎回性价比</view>
        </view>
        <view class="stat-item">
          <view class="stat-value">{{totalDecisions}}</view>
          <view class="stat-label">次</view>
          <view class="stat-desc">决策次数</view>
        </view>
      </view>
    </view>
  </view>

  <!-- 决策统计 -->
  <view class="decision-stats-section">
    <view class="section-title">决策统计</view>
    <view class="decision-stats-card">
      <view class="decision-stat-item">
        <view class="decision-stat-icon">⏰</view>
        <view class="decision-stat-content">
          <view class="decision-stat-value">{{hireDecisions}}</view>
          <view class="decision-stat-label">赎回时间次数</view>
        </view>
      </view>
      <view class="decision-stat-item">
        <view class="decision-stat-icon">🙋‍♂️</view>
        <view class="decision-stat-content">
          <view class="decision-stat-value">{{selfDecisions}}</view>
          <view class="decision-stat-label">自己完成</view>
        </view>
      </view>
      <view class="decision-stat-item">
        <view class="decision-stat-icon">⏰</view>
        <view class="decision-stat-content">
          <view class="decision-stat-value">{{totalRedeemedTimeDisplay}}</view>
          <view class="decision-stat-label">赎回时间(小时)</view>
        </view>
      </view>
    </view>
  </view>

  <!-- 任务类型统计 -->
  <view class="task-type-section" wx:if="{{Object.keys(taskTypeStats).length > 0}}">
    <view class="section-title">任务类型分析</view>
    <view class="task-type-list">
      <view class="task-type-item" wx:for="{{Object.keys(taskTypeStats)}}" wx:key="*this">
        <view class="task-type-name">{{item}}</view>
        <view class="task-type-stats">
          <view class="task-type-stat">
            <text class="task-type-stat-label">次数：</text>
            <text class="task-type-stat-value">{{taskTypeStats[item].count}}</text>
          </view>
          <view class="task-type-stat">
            <text class="task-type-stat-label">时间：</text>
            <text class="task-type-stat-value">{{taskTypeStats[item].redeemedTime.toFixed(1)}}h</text>
          </view>
          <view class="task-type-stat">
            <text class="task-type-stat-label">金额：</text>
            <text class="task-type-stat-value">¥{{taskTypeStats[item].spentMoney.toFixed(0)}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 最近决策记录 -->
  <view class="recent-decisions-section" wx:if="{{recentDecisions.length > 0}}">
    <view class="section-title">最近决策记录</view>
    <view class="recent-decisions-list">
      <view class="recent-decision-item" wx:for="{{recentDecisions}}" wx:key="id">
        <view class="recent-decision-header">
          <view class="recent-decision-title">{{item.taskDescription || item.taskTypeChinese}}</view>
          <view class="recent-decision-result {{item.choseHire ? 'hire' : 'self'}}">
            {{item.choseHire ? '✅ 赎回时间' : '❌ 自己完成'}}
          </view>
        </view>
        <view class="recent-decision-details">
          <text class="recent-decision-time">{{item.estimatedHours}}小时</text>
          <text class="recent-decision-price">¥{{item.outsourcePrice}}</text>
          <text class="recent-decision-date">{{formatTime(item.timestamp)}}</text>
        </view>
      </view>
    </view>
    <view class="view-all-history" bindtap="viewDetailHistory">
      查看全部历史记录 →
    </view>
  </view>

</view>