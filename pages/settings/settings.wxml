<view class="container">
  <!-- 页面标题 -->
  <view class="header card-base">
    <text class="title">设置中心</text>
    <text class="subtitle">个人信息与应用设置</text>
  </view>

  <!-- 时间管理者卡片 -->
  <view class="user-info-section">
    <view class="user-info-card card-base">
      <!-- 使用微信最新的头像选择按钮 -->
      <button 
        class="avatar-btn" 
        open-type="chooseAvatar" 
        bindchooseavatar="onChooseAvatar"
      >
        <image wx:if="{{userInfo.avatarUrl}}" class="avatar-image" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
        <text wx:else class="avatar-text">{{userInfo.name.charAt(0)}}</text>
      </button>
      
      <view class="user-details">
        <!-- 昵称输入框 -->
        <view class="nickname-input-section">
          <input 
            class="nickname-input"
            type="text" 
            placeholder="请输入昵称" 
            value="{{userInfo.name}}"
            bindinput="onInputNickname"
            maxlength="20"
          />
          <text class="nickname-hint">点击输入您的昵称</text>
        </view>
        
        <!-- 登录状态显示 -->
        <view class="login-status">
          <text wx:if="{{isLoggedIn}}" class="login-status-text login-success">
            {{isMockLogin ? '✅ 模拟登录' : '✅ 微信登录'}}
          </text>
          <text wx:else class="login-status-text login-pending">⏳ 未登录</text>
        </view>
        
        <view class="user-stats">
          <text class="user-stat">时间价值: ¥{{userInfo.timeValueDisplay}}/小时</text>
          <text class="user-stat">已买回: {{statistics.totalSavedTimeDisplay}}小时</text>
          <text class="user-stat">等效价值: ¥{{statistics.equivalentValueDisplay}}</text>
        </view>
      </view>
    </view>
    
    <!-- 微信登录和设置按钮 -->
    <view class="wechat-info-section">
      <!-- 微信快捷登录按钮 -->
      <view wx:if="{{!isLoggedIn}}" class="wechat-quick-login-btn card-base" bindtap="wechatQuickLogin">
        <view class="wechat-icon">🚀</view>
        <view class="wechat-text">微信账号快捷登录</view>
        <view class="wechat-arrow">→</view>
      </view>
      
      <!-- 用户信息设置说明 -->
      <view class="wechat-info-btn card-base" bindtap="showWechatLoginGuide">
        <view class="wechat-icon">👤</view>
        <view class="wechat-text">{{isLoggedIn ? '用户信息设置说明' : '手动设置头像和昵称'}}</view>
        <view class="wechat-arrow">→</view>
      </view>
      
      <!-- 重置用户信息按钮 -->
      <view class="logout-btn card-base" bindtap="resetUserInfo">
        <view class="logout-icon">🔄</view>
        <view class="logout-text">重置用户信息</view>
        <view class="logout-arrow">→</view>
      </view>
      
      <!-- 手机号获取按钮 -->
      <view wx:if="{{isLoggedIn}}" class="phone-section card-base">
        <button 
          class="phone-btn" 
          open-type="getPhoneNumber" 
          bindgetphonenumber="getPhoneNumber">
          <view class="phone-icon">📱</view>
          <view class="phone-text">获取手机号</view>
        </button>
        <text wx:if="{{phoneNumber}}" class="phone-display">{{phoneNumber}}</text>
      </view>
      
      <!-- 完成设置按钮 -->
      <view wx:if="{{isLoggedIn}}" class="complete-section card-base">
        <button 
          class="complete-btn" 
          bindtap="checkUserInfoComplete">
          <view class="complete-icon">✅</view>
          <view class="complete-text">完成设置</view>
        </button>
      </view>
      
    </view>
  </view>




  <!-- 使用帮助 -->
  <view class="help-section">
    <view class="section-title">使用帮助</view>
    <view class="help-content card-base">
      <view class="help-step">
        <view class="help-step-icon">🧮</view>
        <view class="help-step-content">
          <text class="help-step-title">计算时间价值</text>
          <text class="help-step-desc">在计算器页面中算出你每小时的时间价值</text>
        </view>
      </view>
      
      <view class="help-step">
        <view class="help-step-icon">🤖</view>
        <view class="help-step-content">
          <text class="help-step-title">智能决策分析</text>
          <text class="help-step-desc">在决策页面中理性的判断，是否赎回自己的时间（与自己的时间价值做对比）</text>
        </view>
      </view>
      
      <view class="help-step">
        <view class="help-step-icon">📈</view>
        <view class="help-step-content">
          <text class="help-step-title">查看管理成果</text>
          <text class="help-step-desc">你可在统计页面查看自己时间赎回的成果</text>
        </view>
      </view>
      
      <view class="help-step">
        <view class="help-step-icon">💡</view>
        <view class="help-step-content">
          <text class="help-step-title">核心理念</text>
          <text class="help-step-desc">时间赎回器的理念是：金钱只是用来购买时间的工具！</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 意见反馈 -->
  <view class="feedback-section">
    <view class="section-title">意见反馈</view>
    <view class="feedback-content card-base">
      <view class="feedback-item" bindtap="feedback">
        <view class="feedback-icon">📝</view>
        <view class="feedback-text">意见反馈</view>
        <view class="feedback-arrow">→</view>
      </view>
      
      <view class="feedback-item" bindtap="aboutApp">
        <view class="feedback-icon">ℹ️</view>
        <view class="feedback-text">关于时间赎回器</view>
        <view class="feedback-version">v{{version}}</view>
        <view class="feedback-arrow">→</view>
      </view>
    </view>
  </view>

  <!-- 数据管理 -->
  <view class="data-section">
    <view class="section-title">数据管理</view>
    <view class="data-content card-base">
      <view class="data-item" bindtap="resetAllData">
        <view class="data-icon">🗑️</view>
        <view class="data-text">重置所有数据</view>
        <view class="data-arrow">→</view>
      </view>
    </view>
  </view>

  <!-- 版权信息 -->
  <view class="copyright-section">
    <view class="copyright-text card-base">
      <text class="copyright-line">基于《买回你的时间》理念开发</text>
      <text class="copyright-line">"金钱仅仅是用来购买时间的工具"</text>
      <text class="copyright-line">© 2025 时间赎回器 {{version}}</text>
    </view>
  </view>
</view> 