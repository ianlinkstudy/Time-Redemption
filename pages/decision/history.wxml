<!--pages/decision/history.wxml-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header card-base">
    <text class="title">å†³ç­–å†å²</text>
    <text class="subtitle">æŸ¥çœ‹æ‚¨çš„æ‰€æœ‰å†³ç­–è®°å½•</text>
  </view>

  <!-- å†å²è®°å½•åˆ—è¡¨ -->
  <view class="history-list" wx:if="{{historyList.length > 0}}">
    <view class="history-item card-base" wx:for="{{historyList}}" wx:key="id" data-index="{{index}}" bindtap="viewHistoryDetail">
      <view class="history-header">
        <view class="task-info">
          <view class="task-title">{{item.taskDescription}}</view>
          <view class="task-meta">
            <text class="task-type">{{item.taskType}}</text>
            <text class="task-time">{{item.estimatedHours}}å°æ—¶</text>
            <text class="task-price">Â¥{{item.outsourcePrice}}</text>
          </view>
        </view>
        <view class="decision-result {{item.analysis.decision === 'hire' ? 'hire' : 'self'}}">
          <view class="result-icon">{{item.analysis.decision === 'hire' ? 'ğŸ‘¥' : 'ğŸ™‹â€â™‚ï¸'}}</view>
          <view class="result-text">{{item.analysis.recommendation}}</view>
        </view>
      </view>
      
      <view class="history-details">
        <view class="detail-row">
          <text class="detail-label">å¤–åŒ…å•ä»·:</text>
          <text class="detail-value">Â¥{{item.analysis.pricePerHour.toFixed(2)}}/å°æ—¶</text>
        </view>
        <view class="detail-row">
          <text class="detail-label">æ—¶é—´ä»·å€¼:</text>
          <text class="detail-value">Â¥{{item.userTimeValue.toFixed(2)}}/å°æ—¶</text>
        </view>
        <view class="detail-row {{item.analysis.savings > 0 ? 'positive' : 'negative'}}">
          <text class="detail-label">{{item.analysis.savings > 0 ? 'èŠ‚çœ' : 'é¢å¤–æ”¯å‡º'}}:</text>
          <text class="detail-value">{{item.analysis.savings > 0 ? '+' : ''}}Â¥{{item.analysis.savings.toFixed(2)}}</text>
        </view>
      </view>
      
      <view class="history-footer">
        <view class="timestamp">{{formatTime(item.timestamp)}}</view>
        <view class="actions">
          <button class="btn-mini btn-danger" catchtap="deleteHistory" data-index="{{index}}">åˆ é™¤</button>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state card-base" wx:if="{{historyList.length === 0}}">
    <view class="empty-icon">ğŸ“‹</view>
    <view class="empty-title">æš‚æ— å†³ç­–è®°å½•</view>
    <view class="empty-desc">æ‚¨è¿˜æ²¡æœ‰è¿›è¡Œè¿‡ä»»ä½•å†³ç­–åˆ†æ</view>
    <button class="btn btn-primary" bindtap="goToDecision">å»è¿›è¡Œå†³ç­–</button>
  </view>

  <!-- åº•éƒ¨æ“ä½œ -->
  <view class="bottom-actions" wx:if="{{historyList.length > 0}}">
    <button class="btn btn-danger" bindtap="clearAllHistory">æ¸…ç©ºå…¨éƒ¨å†å²</button>
  </view>
</view> 